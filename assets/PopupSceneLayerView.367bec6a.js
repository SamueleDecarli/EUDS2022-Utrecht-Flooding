import{i as f,n as w,V as u,r as h,dc as F,dd as P}from"./vendor.e52053a0.js";import{s as l,d as m}from"./popupUtils.b53d8c6c.js";const b=d=>{let r=class extends d{_validateFetchPopupFeatures(p){const{layer:e}=this,{popupEnabled:s}=e;return s?l(e,p)?void 0:new u("scenelayerview3d:fetchPopupFeatures","Layer does not define a popup template",{layer:e}):new u("scenelayerview3d:fetchPopupFeatures","Popups are disabled",{layer:e})}async prepareFetchPopupFeatures(p){}async fetchPopupFeatures(p,e){const s=this._validateFetchPopupFeatures(e);if(s)throw s;const i=h(e)?e.clientGraphics:null;if(!i||i.length===0)return[];const y=this.layer.type==="scene"&&h(this.layer.associatedLayer)?this.layer.associatedLayer:this.layer,c=F(this.layer.fieldsIndex,await m(y,l(this.layer,e)));await this.prepareFetchPopupFeatures(c);const o=new Set,n=[],a=[];for(const t of i)P(c,t,o)?a.push(t):n.push(t);return a.length===0?n:this.whenGraphicAttributes(a,[...o]).catch(()=>a).then(t=>n.concat(t))}};return r=f([w("esri.views.3d.layers.support.PopupSceneLayerView")],r),r};export{b as c};
